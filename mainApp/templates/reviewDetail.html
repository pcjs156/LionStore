{% extends 'base.html' %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/reviewdetail.css' %}">

{% block head %}
<title>ë¦¬ë·° ìƒì„¸ ì •ë³´</title>
<!-- ë¦¬ë·° ìƒì„¸ ì •ë³´ê°€ ë…¸ì¶œë¨. ì—¬ê¸°ì„œ ë¦¬ë·°ì˜ ìˆ˜ì •/ì‚­ì œì— ì ‘ê·¼í•¨.  -->
<style>
    * {
  box-sizing: border-box;
}

/* Create two unequal columns that floats next to each other */
.column {
  float: left;
  padding: 0px;
  
}

.img {
  width: 35%;
}

.content {
    padding-left: 5px;
    width: 65%;
}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}
    article {
        width: 70%;
        margin: 2rem auto;
    }

    .blog-comment::before,
    .blog-comment::after,
    .blog-comment-form::before,
    .blog-comment-form::after {
        content: "";
        display: table;
        clear: both;
    }

    .blog-comment ul {
        list-style-type: none;
        padding: 0;
    }

    .blog-comment img {
        opacity: 1;
        filter: Alpha(opacity=100);
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        -o-border-radius: 4px;
        border-radius: 4px;
    }

    .blog-comment img.avatar {
        position: relative;
        float: left;
        width: 65px;
        height: 65px;
    }

    .blog-comment .post-comments {
        border: 1px solid #eee;
        margin-bottom: 20px;
        padding: 2rem 2rem 0 2rem;
        position: relative;
        -webkit-border-radius: 4px;
        -moz-border-radius: 4px;
        -o-border-radius: 4px;
        border-radius: 4px;
        background: #fff;
        color: #6b6e80;
        position: relative;
    }

    .blog-comment .meta {
        color: #aaaaaa;
        padding-bottom: 8px;
        margin-bottom: 10px !important;
    }

    .blog-comment ul.comments ul {
        list-style-type: none;
        padding: 0;
    }

    .blog-comment-form {
        padding-top: 40px;
    }

    .blog-comment h3,
    .blog-comment-form h3 {
        margin-bottom: 40px;
        line-height: 30px;
        font-weight: 800;
    }

    @font-face {
        font-family: 'NanumSquareRound';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_two@1.0/NanumSquareRound.woff') format('woff');
        font-weight: normal;
        font-style: normal;
    }
</style>
{% endblock %}

{% block content %}
<article>
    <!-- ë§¨ìœ—ìƒë‹¨ ì„¤ëª… -->
    <p id="link_nav" style="text-align: left; margin-left: -0.5rem; margin-bottom: 0.5rem;">
        <a href="{% url 'productDetail' review.product.id %}"><i class="fa fa-pencil"
                aria-hidden="true"></i></i>{{ review.product.name }}</a> >
        <span id="current_location">{{ review.getShortComment }}</span>
    </p>
<!-- ë§¨ìœ—ìƒë‹¨ ì„¤ëª… ë -->

<!-- í˜ì´ì§€ ì™¼ìª½ ! ì´ë¯¸ì§€ -->

<div class="column img" >
    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner"> 
            <div class="carousel-item active">
                {% for image in images %}
                {% if image %}
                {% if review.author == user %}
                <a href="{% url 'reviewImageModify' review_id=review.id imageIdx=forloop.counter0 %}">
                <img src="{{ image.url }}" class="d-block w-100" style="width:350px; height:350px;">
                </a>
                {% else %}
                <img src="{{ image.url }}" class="d-block w-100" style="width:350px; height:350px;">
                {% endif %}
            </div>
        </div>
            <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
    </div>
</div>

    {% endif %}
    {% endfor %}
    <br><br>
    <div style="font-family: yg-jalnan;"><button class="site-btn"><a href="" data-toggle="modal" data-target="#reviewImageAddModal" style="color: white;">
        ë¦¬ë·° ì´ë¯¸ì§€ ì¶”ê°€í•˜ê¸°</a></button></div>    
</div>
<!-- í˜ì´ì§€ ì˜¤ë¥¸ìª½ ! ì„¤ëª… -->

<div class="column content" >
    <!-- <div class="row" style="display: grid; grid-template-rows: 0fr 0.5fr 0.3fr 0.01fr; padding-left: 20px;"> -->
             <!-- ì œí’ˆì œëª© -->
             <div style="font-family: yg-jalnan; color: rgb(80, 42, 27); font-size: 22px; text-align: left;">
                {{ review.product.name }}
            </div>
             <!-- ì œí’ˆì œëª© ë-->

            {% if canAddImage and isAuthor %}
            <!-- Button trigger modal -->
            <br>
            {% endif %}
            <div style="font-family: nanumsquareround;"><b>ë¦¬ë·°ì–´ <span style="font-size: 20px; color:rgb(94, 64, 10);">{{ author }}</span> ë‹˜ì˜ ê¸€</b></div>
            <br>
            <div style="font-family: nanumsquareround;">
            <div><b>ì œí’ˆëª…</b>  {{ product }}</div>
            <div><b>í•œì¤„í‰</b>  {{ comment }} </div>
            <div><b>ì¥ì </b>  {{ goodPoint }}</div>
            <div><b>ë‹¨ì </b>  {{ weakPoint }}</div>
            </div>
            <hr>
<!-- ì ìˆ˜ ë§¤ê¸°ê¸° ì‹œì‘ -->
<div style="font-family: nanumsquareround; font-weight: bolder;">
            <div>ì´ì </div>
            <div class="rateit svg" data-rateit-value="{{totalScore}}" data-rateit-readonly="true" data-rateit-starwidth="15"
                step="0.1" data-rateit-starheight="15"></div>
                <br>
    <div class="row">
        <div class="col">           
            <div>{{gripScore.name}}</div>
            <div class="rateit svg" data-rateit-value="{{gripScore.score}}" data-rateit-readonly="true"
                aria-valuenow="{{gripScore.score}}" data-rateit-starwidth="15" data-rateit-starheight="15"></div>
                <br>
        </div>
        <div class="col"> 
            <div>{{lifeScore.name}}</div>
            <div class="rateit svg" data-rateit-value="{{lifeScore.score}}" data-rateit-readonly="true"
                data-rateit-starwidth="15" data-rateit-starheight="15"></div>
                <br>
        </div>
    </div>

    <div class="row">
        <div class="col"> 
            <div>{{durabilityScore.name}}</div>
            <div class="rateit svg" data-rateit-value="{{durabilityScore.score}}" data-rateit-readonly="true"
                data-rateit-starwidth="15" data-rateit-starheight="15"></div>
                <br>
        </div>
        <div class="col"> 
            <div>{{designScore.name}}</div>
            <div class="rateit svg" data-rateit-value="{{designScore.score}}" data-rateit-readonly="true"
                data-rateit-starwidth="15" data-rateit-starheight="15"></div>
                <br>
        </div>
    </div>

    <div class="row">
        <div class="col">
            <div>{{textureScore.name}}</div>
            <div class="rateit svg" data-rateit-value="{{textureScore.score}}" data-rateit-readonly="true"
                data-rateit-starwidth="15" data-rateit-starheight="15"></div>
                <br>
        </div>
        <div class="col">
            <div>{{costEffetivenessScore.name}}</div>
            <div class="rateit svg" data-rateit-value="{{costEffetivenessScore.score}}" data-rateit-readonly="true"
                data-rateit-starwidth="15" data-rateit-starheight="15"></div>
        </div>
    </div>
</div>
    
    <!-- íƒœê·¸ ê´€ë ¨ -->
<div>
    <div id="tagContainer" style="margin: 0 auto 1rem auto; text-align: right;">
        <div style="font-family: 'yg-jalnan'; color: black;"><i class="fa fa-tags" aria-hidden="true"></i>íƒœê·¸ëª©ë¡</div>
        {% if productTags %}
        {% for tag in productTags %}
        <a class="badge badge-pill badge-warning" href="{% url 'tagProduct' tag.id %}">{{ tag }}</a>
        {% endfor %}
        {% else %}
        <span class="badge badge-pill badge-danger">No TAG</span>
        {% endif %}
    </div>

    <div id="tagContainer" style="margin: 0 auto 1rem auto; text-align: right;">
        <div style="font-family: 'yg-jalnan'; color: black;"><i class="fa fa-tags" aria-hidden="true"></i>ë¦¬ë·°ì–´ íƒœê·¸</div>
        {% if userTags %}
        {% for tag in userTags %}
        <a class="badge badge-pill badge-warning" href="{% url 'reviewsByTag' tagName=tag.tagBody %}">{{ tag }}</a>
        {% endfor %}
        {% else %}
        <span class="badge badge-pill badge-danger">No TAG</span>
        {% endif %}
    </div>

    <div style="text-align: right;">
        {{ likeMessage }}
        <a href="{% url 'reviewLikeProcess' review_id=review.id %}">
            {% if userLike %}
            <!-- ìœ ì €ê°€ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥¸ ê²½ìš° -->
            â¤ï¸
            {% else %}
            <!-- ìœ ì €ê°€ ì¢‹ì•„ìš”ë¥¼ ëˆ„ë¥´ì§€ ì•Šì€ ê²½ìš° -->
            ğŸ–¤
            {% endif %}
        </a>
    </div>
</div>   

    {% if review.modified %}
    <div style="text-align: right; font-size: smaller; color: gray;">Modified on
        {{ review.pub_date | date:"Y-m-d h:i" }}
    </div>
    {% else %}
    <div style="text-align: right; font-size: smaller; color: gray;">Posted On {{ review.pub_date | date:"Y-m-d h:i" }}
    </div>
    {% endif %}

    {% if isAuthor %}
    <div style="text-align: right; color: black; font-size: x-small;">
        <a href="{% url 'reviewModify' review.id %}">ë¦¬ë·° ìˆ˜ì •</a> / 
        <a href="" data-toggle="modal" data-target="#deleteModal" style="color: black;">ê²Œì‹œê¸€ ì‚­ì œí•˜ê¸°</a>
    </div>
   
    {% endif %}

<br>
</div>




<!-- ëŒ“ê¸€ ê´€ë ¨ -->
<br>
<div id="reviewContainer" style="padding: 0 0%">
    {% if user.is_authenticated %}
    <div class="alert alert-secondary"
        style="display: grid; grid-template-columns: 1fr 10fr; padding: 1rem 1rem 1rem 0rem;">
        <div style="text-align: left;">
            <div>
                <img class="profile_image" src="{{ user.image.url }}" alt="{{ user.nickname }}ë‹˜ì˜ í”„ë¡œí•„ ì´ë¯¸ì§€"
                    style="max-width: 40px; max-height: 40px; width: auto; height: auto; display: block; margin:0px auto;">
            </div>
            <div style="text-align: center; font-family: 'nanumsquareround';">
                {{ user.nickname }}
            </div>
        </div>
        <form action="/store/commentCreate/{{ review.id }}" method="POST">
            <div class="post-comments" style="height: 125%;">
                {% csrf_token %}
                <input type="text" name="body" style="width: 90%; height: 80%; border: 0px; border-radius: 5px;">&nbsp;
                    <button type="submit" class="site-btn">    ëŒ“ê¸€ ì‘ì„±</button>
                </div>
            </div>
        </form>
    </div>
    {% else %}
    <div class="alert alert-secondary">
        <div style="text-align: center; font-family: 'yg-jalnan';">
            ëŒ“ê¸€ì„ ì‘ì„±í•˜ì‹œë ¤ë©´ ë¨¼ì € [ <a id="loginLink" href="{% url 'logIn' %}">ë¡œê·¸ì¸</a> ] í•´ì£¼ì„¸ìš”!
        </div>
    </div>
    {% endif %}

    {% for comment in comments %}
    <div class="blog-comment">
        <div class="post-comments">
        <div style="text-align: left; padding-top: 0rem;">
            
                <!-- <img class="profile_image" src="{{ comment.author.image.url }}"
                    alt="{{ comment.author.nickname }}ë‹˜ì˜ í”„ë¡œí•„ ì´ë¯¸ì§€"
                    style="max-width: 40px; max-height: 40px; width: auto; height: auto; display: block; margin:0px auto;"> -->
        
           <div style="font-family: 'nanumsquareround';">
            <b>   {{ comment.author.nickname }}</b>
            </div>
        </div>
                <p style="padding-right: 2rem;">
                    {{ comment.body }}
                </p>
                <hr>
                <div style="text-align: right; margin-bottom: 0.5rem;">
                    <span style="color: gray; font-size: smaller;">
                        {{ comment.pub_date | date:"Y/m/d a h:i"}}
                        {% if comment.author == request.user %}
                        <a href="{% url 'commentDelete' comment.id %}"><i class="fa fa-trash-o"
                                aria-hidden="true"></i></a>
                        {% endif %}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>
    {% endfor %}


     {% if isAuthor %}
    <!-- Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="deleteModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteModalLabel">ë¦¬ë·° {{ review.id }}</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?
                </div>
                <div class="modal-footer">
                    <a href="{% url 'reviewDelete' review.id %}"><button type="button"
                            class="btn btn-danger">ì˜ˆ</button></a>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">ì•„ë‹ˆì˜¤</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Modal -->
    <div class="modal fade" id="reviewImageAddModal" tabindex="-1" role="dialog"
        aria-labelledby="reviewImageAddModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reviewImageAddModalLabel">ë¦¬ë·° ì´ë¯¸ì§€ ì¶”ê°€ : {{ imageLeft }}ì¥ ê°€ëŠ¥</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="{% url 'reviewImageAdd' review.id %}" enctype="multipart/form-data" method="POST">
                        {% csrf_token %}
                        {{ newImageForm.reviewImage1 }}
                        <br>
                </div>
                <div class="modal-footer">
                    <input type="submit" value="ì—…ë¡œë“œ" class="btn btn-success" style="text-align: right;">
                    </form>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">ì·¨ì†Œ</button>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
{% endblock %}